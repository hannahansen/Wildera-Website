<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700;800&display=swap" rel="stylesheet">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wildera | Earrings</title>
  <link href="earrings.css" rel="stylesheet" type="text/css">
</head>
<body>

<header>
  <div class="top-header">
    <h1 class="header-title" aria-label="Wildera">
      <span class="logo-wild">WILD</span><span class="logo-era">ERA</span>
    </h1>

    <input type="checkbox" id="menu-toggle"/>
    <label for="menu-toggle" class="menu-button"><span>Menu</span></label>

    <nav class="menu">
      <ul>
        <li><a href="index.html#home">Home</a></li>
        <li><a href="shop.html">Shop</a></li>
        <li><a href="index.html#about">About</a></li>
        <li><a href="faq.html">FAQ</a></li>
        <li><a href="index.html#contact">Contact</a></li>
        <li><a href="cart.html">Cart</a></li>
      </ul>
    </nav>
  </div>
</header>

<main class="product-list">

  <section class="collection" aria-label="Earrings collection">
    <h2 class="collection-title">Earrings</h2>
    <p class="collection-subtitle">browse the collection, then tap for details.</p>
    <div class="collection-grid" id="collection-grid"></div>
  </section>

  <hr class="collection-divider" aria-hidden="true" />

  <!-- PRODUCT 1 -->
  <section class="product-card"
  data-product-id="earrings-1"
  data-product-name="Micro Pave CZ Hoop Earring Set"
  data-product-price="34"
  data-product-stock="2"
  data-stripe-price-id="price_1Sp3Aj3KjNgHTC3Y9e4FoyKY"
  data-product-image="images/A49A9014.jpg">
    <div class="product-info">
      <h2 class="product-title">18k Gold Micro Pave CZ Earring Set</h2>
      <p class="product-subtitle">Two pairs of petite earrings with a clean, sparkly finish.</p>
      <div class="product-meta">
        <span class="product-price"></span>
        <span class="product-stock"></span>
      </div>
      <div class="product-details">
        <p><strong>Materials:</strong> <br>Huggie Earrings: 925 sterling silver (925 stamp) with real 18K gold plating. <br>Stud Earrings: a second pair in stainless steel with 18K gold plating. Both feature cubic zirconia.</p>
        <p><strong>Size:</strong> 10.4mm wide × 13mm long (0.41in × 0.51in)</p>
        <p><strong>Notes:</strong> Micro pave CZ sparkle, lightweight feel, easy everyday hoops.</p>
      </div>
      <p class="product-description">
        A simple, elevated hoop moment. This set includes two pairs of petite earrings. Micro pave cubic zirconia creates a clean sparkle you can wear with anything.
      </p>
      <div class="product-actions">
        <button type="button" class="add-to-cart">Add to cart</button>
        <p class="cart-status" aria-live="polite"></p>
      </div>
    </div>

    <div class="product-media">
      <div class="carousel">
        <button class="carousel-btn prev" type="button" aria-label="Previous photo">‹</button>

        <div class="carousel-track">
          <img class="carousel-slide" src="images/A49A9024.jpg" alt="Photo 1">
          <img class="carousel-slide" src="images/A49A9033.jpg" alt="Photo 2">
          <img class="carousel-slide" src="images/A49A9014.jpg" alt="Photo 3">
        </div>

        <button class="carousel-btn next" type="button" aria-label="Next photo">›</button>
      </div>
    </div>
  </section>

  <!-- PRODUCT 2 -->
  <section class="product-card"
    data-product-id="earrings-2"
    data-product-name="Micro Pave CZ Flower Stud Earrings"
    data-product-price="24"
    data-product-stock="1"
    data-stripe-price-id="price_1Sp3Db3KjNgHTC3YQxOkPgaG"
    data-product-image="images/A49A9047.jpg">

    <div class="product-info">
      <h2 class="product-title">18k Gold Micro Pave CZ Flower Stud Earrings</h2>

      <p class="product-subtitle">
        Petite flower studs with cubic zirconia sparkle and a natural pearl center.
      </p>

      <div class="product-meta">
        <span class="product-price"></span>
        <span class="product-stock"></span>
      </div>

      <div class="product-details">
        <p>
          <strong>Materials:</strong>
          925 sterling silver, real 18k gold plating, micro pave cubic zirconia, natural pearl
        </p>
        <p>
          <strong>Size:</strong>
          6mm length, flower 3mm wide
        </p>
        <p>
          <strong>Notes:</strong>
          Lightweight stud earrings with a delicate floral design and subtle pearl detail. Circular screw on backing.
        </p>
      </div>

      <p class="product-description">
        A soft, feminine take on everyday studs. These micro pave cubic zirconia flower earrings feature a
        natural pearl center and a real 18k gold plated finish over sterling silver. Easy to wear, lightweight,
        and perfect for daily styling or layering with other earrings.
      </p>

      <div class="product-actions">
        <button type="button" class="add-to-cart">Add to cart</button>
        <p class="cart-status" aria-live="polite"></p>
      </div>
    </div>

    <div class="product-media">
      <div class="carousel">
        <button class="carousel-btn prev" type="button" aria-label="Previous photo">‹</button>

        <div class="carousel-track">
          <img class="carousel-slide" src="images/A49A9052-2.jpg" alt="Flower stud earrings photo 1">
          <img class="carousel-slide" src="images/A49A9052.jpg" alt="Flower stud earrings photo 2">
          <img class="carousel-slide" src="images/A49A9047.jpg" alt="Flower stud earrings photo 3">
        </div>

        <button class="carousel-btn next" type="button" aria-label="Next photo">›</button>
      </div>
    </div>
  </section>

</main>

<section class="connect">
  <div class="connect-content">
    <h2>Connect On Social Media!</h2>
    <a href="https://www.tiktok.com/@wildera.jewelry/">
      <img src="tiktok.png" alt="Tiktok">
    </a>
    <a href="https://www.instagram.com/wildera.jewelry">
      <img src="instagram.png" alt="Instagram">
    </a>
  </div>
</section>

<footer class="footer">
  <div class="footer-content">
    <p>© 2025 Wildera. All rights reserved.</p>
  </div>
</footer>

<script>
  // Build the top collection grid from the product cards on the page
  (function () {
    const grid = document.getElementById('collection-grid');
    if (!grid) return;

    const cards = Array.from(document.querySelectorAll('.product-card[data-product-id]'));

    cards.forEach((card) => {
      const id = card.getAttribute('data-product-id');
      if (!id) return;

      // Ensure the card has an anchor target
      if (!card.id) card.id = id;

      const name =
        (card.getAttribute('data-product-name') ||
          card.querySelector('.product-title')?.textContent ||
          'product').trim();

      const price = Number(card.getAttribute('data-product-price') || 0);

      const imgSrc =
        card.getAttribute('data-product-image') ||
        card.querySelector('.carousel-slide')?.getAttribute('src') ||
        '';

      const a = document.createElement('a');
      a.className = 'collection-item';
      a.href = `#${card.id}`;

      a.innerHTML = `
        <img src="${imgSrc}" alt="${name}">
        <div class="collection-text">
          <div class="collection-name">${name.toLowerCase()}</div>
          <div class="collection-price">$${price.toFixed(2)}</div>
        </div>
      `;

      grid.appendChild(a);
    });
  })();
</script>

<script>
  (function () {
    // --- Carousel ---
    document.querySelectorAll('.carousel').forEach((carousel) => {
      const slides = Array.from(carousel.querySelectorAll('.carousel-slide'));
      const prev = carousel.querySelector('.carousel-btn.prev');
      const next = carousel.querySelector('.carousel-btn.next');
      if (!slides.length || !prev || !next) return;

      let index = 0;
      function render() {
        slides.forEach((img, i) => (img.style.display = i === index ? 'block' : 'none'));
      }

      prev.addEventListener('click', () => {
        index = (index - 1 + slides.length) % slides.length;
        render();
      });

      next.addEventListener('click', () => {
        index = (index + 1) % slides.length;
        render();
      });

      render();
    });

    // --- Cart (localStorage) ---
    const CART_KEY = 'wildera_cart_v1';

    function loadCart() {
      try {
        return JSON.parse(localStorage.getItem(CART_KEY) || '[]');
      } catch {
        return [];
      }
    }

    function saveCart(cart) {
      localStorage.setItem(CART_KEY, JSON.stringify(cart));
    }

    function getInCartQty(cart, id) {
      const found = cart.find((i) => i.id === id);
      return found ? Number(found.qty || 0) : 0;
    }

    function setStatus(card, text) {
      const el = card.querySelector('.cart-status');
      if (el) el.textContent = text;
    }

    function refreshButtons() {
      const cart = loadCart();

      document.querySelectorAll('.product-card[data-product-id]').forEach((card) => {
        const id = card.getAttribute('data-product-id');
        const stock = Number(card.getAttribute('data-product-stock') || 0);
        const inCart = getInCartQty(cart, id);
        const btn = card.querySelector('.add-to-cart');
        if (!btn) return;

        const priceEl = card.querySelector('.product-price');
        const stockEl = card.querySelector('.product-stock');
        const price = Number(card.getAttribute('data-product-price') || 0);
        if (priceEl) priceEl.textContent = `$${price.toFixed(2)}`;
        if (stockEl) {
          const remainingNow = Math.max(0, stock - inCart);
          stockEl.textContent = `In stock: ${remainingNow}`;
        }

        if (stock <= 0) {
          btn.disabled = true;
          btn.textContent = 'Sold out';
          setStatus(card, '');
          return;
        }

        const remaining = Math.max(0, stock - inCart);

        if (remaining <= 0) {
          btn.disabled = true;
          btn.textContent = 'In cart (max)';
          setStatus(card, 'Max quantity reached for this item.');
        } else {
          btn.disabled = false;
          btn.textContent = 'Add to cart';
          setStatus(card, '');
        }
      });
    }

    document.querySelectorAll('.product-card[data-product-id]').forEach((card) => {
      const btn = card.querySelector('.add-to-cart');
      if (!btn) return;

      btn.addEventListener('click', () => {
        const id = card.getAttribute('data-product-id');
        const name = card.getAttribute('data-product-name') || 'Item';
        const price = Number(card.getAttribute('data-product-price') || 0);
        const stock = Number(card.getAttribute('data-product-stock') || 0);
        const image = card.getAttribute('data-product-image') || '';
        const stripePriceId = card.getAttribute('data-stripe-price-id');

        const cart = loadCart();
        const currentQty = getInCartQty(cart, id);

        if (currentQty >= stock) {
          refreshButtons();
          return;
        }

        const existing = cart.find((i) => i.id === id);
        if (existing) {
        existing.qty = Number(existing.qty || 1) + 1;

        if (!existing.stripePriceId) existing.stripePriceId = stripePriceId;
        } else {
        cart.push({ id, name, price, qty: 1, stock, image, stripePriceId });
        }

        saveCart(cart);
        refreshButtons();
      });
    });

    window.addEventListener('storage', refreshButtons);
    refreshButtons();
  })();
</script>

</body>
</html>